#! /usr/bin/env tclsh

source "$::env(HOME)/bin/lib.tcl"

need light notify-send

set arg [lindex $::argv 0]
set cmd {light}
set notify {notify-send -u low -t 2000 -i redshift-status-}

switch -- [string index $arg 0] {
  {} { set cmd {};      append notify on }
  - { append cmd { -U}; append notify off }
  + { append cmd { -A}; append notify on }
  default { fail "Usage: $ME \[(-|+)percent\]" }
}
if [string length $cmd] {
  set arg [string range $arg 1 end]
  exec {*}$cmd $arg
}
exec {*}$notify lum [exec light -G]%

