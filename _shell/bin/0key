#! /usr/bin/env tclsh

source $::env(HOME)/bin/lib.tcl

need swaymsg notify-send

set dev_std {1:1:AT_Translated_Set_2_keyboard}
set dev_bow {1256:28705:B.O.W_Keyboard}
set arg [lindex $::argv 0]

set dev $dev_std
set spec {}
switch -- [lindex $::argv 0] {
  # possible namespace collision
  bow {
    set ::argv [lrange $::argv 1 end]
    set dev $dev_bow
    set spec bow
  }
}

set arg [lindex $::argv 0]
switch -- $arg {
  hsnt {
    exec swaymsg "input $dev xkb_layout hsnt"
    exec swaymsg "input $dev xkb_options ctrl:nocaps"
  }

  qwerty {
    exec swaymsg "input $dev xkb_layout us"
    exec swaymsg "input $dev xkb_options ctrl:nocaps"
  }
}

switch -- $spec {
  bow {
    exec swaymsg "input $dev xkb_layout bow"
  }
}

if {{} ne $spec} {
  append spec { }
}
exec notify-send -u low -t 2000 -i input-keyboard key $spec$arg

